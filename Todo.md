
`nfs_manager`

Μια εφαρµογή διαχειριστή υπεύθυνο για την οργάνωση της διαδικασίας συγχρονισµού, 
Είναι ο αντίστοιχος διαχειριστής της προηγούµενης εργασίας (fss_manager), 
προσαρµοσµένος για χρήση σε δικτυακό περιβάλλον.»

<!-- 1. ./nfs_manager -l <manager_logfile> -c <config_file> -n <worker_limit> -p <port_number> -b <bufferSize> -->

<!-- 2. Στην αρχή δηµιουργεί ένα socket στο port που δόθηκε ως παράµετρος στο 
command line στο οποίο θα δέχεται µηνύµατα επικοινωνίας από το nfs_console. -->

3. Ετοιµάζει τις διάφορες δοµές δεδοµένων που θα χρειαστεί για το συγχρονισµό των καταλόγων.

4. Ετοιµάζει και δηµιουργεί ένα worker thread pool. Αυτά τα worker threads θα αναλάβουν τη 
δουλειά του συγχρονισµού ένα αρχείο τη φορά.

5. Προετοιµάζει τον συγχρονισµό καταλόγων που καθορίζονται στο config_file.
Η διαδικασία του συγχρονισµού είναι η εξής, για κάθε ζεύγος:
(source_dir@source_host:source_port, target_dir@target_host:target_port):

    - Αρχικά συνδέεται στο source_host:source_port όπου τρέχει ένας nfs_client και στέλνει µια 
    εντολή: LIST source_dir
    - nfs_client διαβάζει αυτή την εντολή και επιστρέφει στον nfs_manager µία λίστα από τα
    αρχεία (ένα σε κάθε γραµµή και θεωρείστε πως δεν έχουµε υποκαταλόγους) που υπάρχουν
    µέσα στο directory source_dir. Το τέλος της λίστας σηµατοδοτείται µε µία τελεία, δηλαδή το
    χαρακτήρα ‘.’. Για παράδειγµα:
        file1.txt
        file2.txt
        file3.txt
        .
    - Εφόσον πάρει τη λίστα αποθηκεύει όλα αυτά τα αρχεία σε ένα buffer µαζί µε την πληροφορία
    για το από πού προέρχονται (δηλαδή το source_host:source_port) και πού πηγαίνουν (δηλαδή
    το target_host, target_port, target_dir).
    - Τυπώνει στην οθόνη, στέλνει στο nfs_console, και γράφει στο manager-log-file
    [2025-02-10 10:00:01] Added file: /dir1/file1@1.2.3.4:8080 -> /dir2/file1@4.5.6.7:8090

`worker`

Εφόσον υπάρχουν αρχεία στο buffer, κάθε worker thread δουλεύει ως εξής:
1. Παίρνει ένα entry από το buffer και ανοίγει socket connections στα source και target hosts.
Κατόπιν, στέλνει την εντολή: PULL /source_dir/file.txt στον source nfs_client. 
Σε αυτό το σηµείο ο nfs_client επιστρέφει πίσω στο thread το περιεχόµενο του file1.txt. 
Προσοχή το thread διαβάζει σε κάποιο buffer (δικό του όχι global) που δεν είναι απαραίτητο πως χωράει 
όλο το αρχείο οπότε θα πρέπει να κάνετε πολλαπλά reads.
2. Ταυτόχρονα το worker thread για κάθε chunk που διάβασε, στέλνει στο target_host:target_port
nfs_client την εντολή: PUSH /target_dir/file.txt chunk_size data 
όπου chunk_size είναι το µέγεθος των data που περιµένει να λάβει σε αυτό το request (όχι το µέγεθος του αρχείου).

Όταν το chunk_size είναι -1 τότε σηµαίνει πως το αρχείο θα ανοιχτεί για γράψιµο από την
αρχή. Όταν το chunk_size είναι 0 τότε σηµαίνει πως δεν υπάρχουν άλλα data και άρα έχουµε
EOF οπότε το αρχείο µπορεί να κλείσει από τον target nfs_client

Για λόγους απλότητας θεωρήστε ότι οι κατάλογοι ειναι flat και περιέχουν µόνο αρχεία και όχι
υποκαταλόγους. Επίσης προσοχή τα threads θα πρέπει να έχουν δικά τους Ι/Ο buffers και θα
πρέπει να κάνετε συγχρονισµό στην ουρά που έχει όλα τα requests των αρχείων µε condition
variables.


`nfs_console`

Μία διεπαφή χρήστη για τη διαχείριση και την υποβολή ερωτηµάτων στο σύστηµα


`nfs_client` 

Μια εφαρµογή που αναλαµβάνει τη µεταφορά των αρχείων.

`config_file`

περιέχει ζεύγη από source/target directories, host και το port µε το οποίο θα υπάρχει 
η επικοινωνία καθώς επίσης και το αντίστοιχο directory. 
Για παράδειγµα: /source1@123.10.10.20:8000 /source2@100.200.10.10:8080

Στο παραπάνω παράδειγµα η δουλειά του `nfs_manager` θα είναι να συγχρονίσει το 
directory/source1 από τον host 123.10.10.20 που ακούει στο port 8000 
µε το directory /source2 στον host 100.200.10.10 που ακούει στο port 8080.

Προσοχή: Για λόγους ασφάλειας τα paths είναι relative από το directory που τρέχει ο κάθε
nfs_client. Αν για παράδειγµα ένας nsf_client ξεκινάει µέσα στο directory /home/user/mydir τότε
το /source1 πιο πάνω σηµαίνει /home/user/mydir/source1 και όχι /source1 δηλαδή όχι από το
root directory.